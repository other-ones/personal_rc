cp: cannot stat 'datasets_pkgs': No such file or directory
/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000 exp_dir
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/src/command.txt command_path
cd_generate.py item
--pretrained_model_name_or_path=runwayml/stable-diffusion-v1-5 item
--train_data_dir1=/data/twkim/diffusion/personalization/collected/images/duck_toy item
--placeholder_token1=<duck_toy> item
--resolution=512 item
--eval_batch_size=15 item
--num_images_per_prompt=8 item
--output_dir=results/cd_results/single_mtarget_seed7777_rep1/duck_toy item
--seed=7777 item
--mask_tokens=[MASK] item
--resume_cd_path=saved_models/cd_models/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr1e5/checkpoints/checkpoint-500/custom_diffusion.pt item
--learned_embed_path1=saved_models/cd_models/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti/checkpoints/checkpoint-1000/learned_embeds.pt item
--dst_exp_path=results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000 item
--train_prior_concept1=duck item
--eval_prior_concept1=duck toy item
--train_prompt_type=nonliving item
--eval_prompt_type=nonliving item
--benchmark_path=../datasets_pkgs/eval_prompts/dreambooth.json item
--include_prior_concept=1 item
/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py inspect
load learned embeddings


unet parameters loaded
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:13,  2.72s/it]  4%|▍         | 2/50 [00:05<02:01,  2.53s/it]  6%|▌         | 3/50 [00:07<01:56,  2.47s/it]  8%|▊         | 4/50 [00:09<01:52,  2.44s/it] 10%|█         | 5/50 [00:12<01:49,  2.43s/it] 12%|█▏        | 6/50 [00:14<01:46,  2.41s/it] 14%|█▍        | 7/50 [00:17<01:43,  2.41s/it] 16%|█▌        | 8/50 [00:19<01:41,  2.41s/it] 18%|█▊        | 9/50 [00:21<01:38,  2.41s/it] 20%|██        | 10/50 [00:24<01:36,  2.41s/it] 22%|██▏       | 11/50 [00:26<01:33,  2.41s/it] 24%|██▍       | 12/50 [00:29<01:31,  2.40s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.41s/it] 28%|██▊       | 14/50 [00:33<01:26,  2.40s/it] 30%|███       | 15/50 [00:36<01:24,  2.41s/it] 32%|███▏      | 16/50 [00:38<01:21,  2.40s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.40s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.41s/it] 38%|███▊      | 19/50 [00:45<01:14,  2.41s/it] 40%|████      | 20/50 [00:48<01:12,  2.41s/it] 42%|████▏     | 21/50 [00:50<01:09,  2.41s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.41s/it] 46%|████▌     | 23/50 [00:55<01:04,  2.41s/it] 48%|████▊     | 24/50 [00:58<01:02,  2.41s/it] 50%|█████     | 25/50 [01:00<01:00,  2.41s/it] 52%|█████▏    | 26/50 [01:02<00:57,  2.41s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.41s/it] 56%|█████▌    | 28/50 [01:07<00:53,  2.42s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.42s/it] 60%|██████    | 30/50 [01:12<00:48,  2.42s/it] 62%|██████▏   | 31/50 [01:14<00:45,  2.42s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.42s/it] 66%|██████▌   | 33/50 [01:19<00:41,  2.41s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:24<00:36,  2.41s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.41s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.41s/it] 76%|███████▌  | 38/50 [01:31<00:28,  2.42s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.41s/it] 80%|████████  | 40/50 [01:36<00:24,  2.42s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:41<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:43<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.42s/it] 90%|█████████ | 45/50 [01:48<00:12,  2.41s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:53<00:07,  2.41s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.41s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.41s/it]100%|██████████| 50/50 [02:00<00:00,  2.41s/it]100%|██████████| 50/50 [02:00<00:00,  2.42s/it]
1 14 1.6792199611663818
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:08,  2.63s/it]  4%|▍         | 2/50 [00:05<01:59,  2.50s/it]  6%|▌         | 3/50 [00:07<01:55,  2.47s/it]  8%|▊         | 4/50 [00:09<01:52,  2.44s/it] 10%|█         | 5/50 [00:12<01:49,  2.44s/it] 12%|█▏        | 6/50 [00:14<01:46,  2.43s/it] 14%|█▍        | 7/50 [00:17<01:44,  2.43s/it] 16%|█▌        | 8/50 [00:19<01:41,  2.43s/it] 18%|█▊        | 9/50 [00:21<01:39,  2.43s/it] 20%|██        | 10/50 [00:24<01:36,  2.42s/it] 22%|██▏       | 11/50 [00:26<01:34,  2.42s/it] 24%|██▍       | 12/50 [00:29<01:31,  2.42s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.43s/it] 28%|██▊       | 14/50 [00:34<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.42s/it] 32%|███▏      | 16/50 [00:38<01:22,  2.41s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.41s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.41s/it] 38%|███▊      | 19/50 [00:46<01:14,  2.41s/it] 40%|████      | 20/50 [00:48<01:12,  2.41s/it] 42%|████▏     | 21/50 [00:50<01:10,  2.42s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.41s/it] 46%|████▌     | 23/50 [00:55<01:05,  2.41s/it] 48%|████▊     | 24/50 [00:58<01:02,  2.41s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:03<00:57,  2.41s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:07<00:53,  2.41s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.41s/it] 60%|██████    | 30/50 [01:12<00:48,  2.41s/it] 62%|██████▏   | 31/50 [01:15<00:45,  2.41s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.41s/it] 66%|██████▌   | 33/50 [01:19<00:41,  2.42s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:24<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.41s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.42s/it] 76%|███████▌  | 38/50 [01:32<00:28,  2.41s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:36<00:24,  2.41s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:41<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.41s/it] 90%|█████████ | 45/50 [01:48<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:53<00:07,  2.41s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.42s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]
2 14 2.526902198791504
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:18,  2.82s/it]  4%|▍         | 2/50 [00:05<02:04,  2.59s/it]  6%|▌         | 3/50 [00:07<01:57,  2.49s/it]  8%|▊         | 4/50 [00:10<01:53,  2.46s/it] 10%|█         | 5/50 [00:12<01:49,  2.43s/it] 12%|█▏        | 6/50 [00:14<01:46,  2.42s/it] 14%|█▍        | 7/50 [00:17<01:43,  2.41s/it] 16%|█▌        | 8/50 [00:19<01:41,  2.41s/it] 18%|█▊        | 9/50 [00:21<01:38,  2.40s/it] 20%|██        | 10/50 [00:24<01:36,  2.40s/it] 22%|██▏       | 11/50 [00:26<01:33,  2.41s/it] 24%|██▍       | 12/50 [00:29<01:31,  2.41s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.41s/it] 28%|██▊       | 14/50 [00:34<01:26,  2.41s/it] 30%|███       | 15/50 [00:36<01:24,  2.41s/it] 32%|███▏      | 16/50 [00:38<01:22,  2.42s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.41s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.42s/it] 38%|███▊      | 19/50 [00:46<01:14,  2.41s/it] 40%|████      | 20/50 [00:48<01:12,  2.42s/it] 42%|████▏     | 21/50 [00:50<01:10,  2.42s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.42s/it] 46%|████▌     | 23/50 [00:55<01:05,  2.42s/it] 48%|████▊     | 24/50 [00:58<01:03,  2.42s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:03<00:58,  2.42s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:07<00:53,  2.42s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.41s/it] 60%|██████    | 30/50 [01:12<00:48,  2.42s/it] 62%|██████▏   | 31/50 [01:15<00:46,  2.42s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.42s/it] 66%|██████▌   | 33/50 [01:20<00:41,  2.42s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:24<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.41s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.42s/it] 76%|███████▌  | 38/50 [01:32<00:29,  2.42s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:36<00:24,  2.42s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:41<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.41s/it] 90%|█████████ | 45/50 [01:49<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:53<00:07,  2.42s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.42s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]
3 14 2.4691617488861084
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:20,  2.88s/it]  4%|▍         | 2/50 [00:05<02:04,  2.60s/it]  6%|▌         | 3/50 [00:07<01:58,  2.51s/it]  8%|▊         | 4/50 [00:10<01:54,  2.48s/it] 10%|█         | 5/50 [00:12<01:50,  2.45s/it] 12%|█▏        | 6/50 [00:14<01:47,  2.45s/it] 14%|█▍        | 7/50 [00:17<01:44,  2.44s/it] 16%|█▌        | 8/50 [00:19<01:42,  2.43s/it] 18%|█▊        | 9/50 [00:22<01:39,  2.43s/it] 20%|██        | 10/50 [00:24<01:37,  2.43s/it] 22%|██▏       | 11/50 [00:27<01:34,  2.42s/it] 24%|██▍       | 12/50 [00:29<01:32,  2.43s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.42s/it] 28%|██▊       | 14/50 [00:34<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.42s/it] 32%|███▏      | 16/50 [00:39<01:22,  2.42s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.42s/it] 36%|███▌      | 18/50 [00:44<01:17,  2.42s/it] 38%|███▊      | 19/50 [00:46<01:14,  2.42s/it] 40%|████      | 20/50 [00:48<01:12,  2.42s/it] 42%|████▏     | 21/50 [00:51<01:10,  2.42s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.43s/it] 46%|████▌     | 23/50 [00:56<01:05,  2.42s/it] 48%|████▊     | 24/50 [00:58<01:03,  2.43s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:03<00:58,  2.42s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:08<00:53,  2.42s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.42s/it] 60%|██████    | 30/50 [01:13<00:48,  2.43s/it] 62%|██████▏   | 31/50 [01:15<00:46,  2.42s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.43s/it] 66%|██████▌   | 33/50 [01:20<00:41,  2.42s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:25<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.43s/it] 74%|███████▍  | 37/50 [01:30<00:31,  2.42s/it] 76%|███████▌  | 38/50 [01:32<00:29,  2.43s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:37<00:24,  2.42s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:42<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.42s/it] 90%|█████████ | 45/50 [01:49<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:54<00:07,  2.42s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.43s/it] 98%|█████████▊| 49/50 [01:59<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.43s/it]100%|██████████| 50/50 [02:01<00:00,  2.43s/it]
4 14 1.0938427448272705
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:14,  2.74s/it]  4%|▍         | 2/50 [00:05<02:02,  2.55s/it]  6%|▌         | 3/50 [00:07<01:56,  2.49s/it]  8%|▊         | 4/50 [00:09<01:53,  2.46s/it] 10%|█         | 5/50 [00:12<01:49,  2.44s/it] 12%|█▏        | 6/50 [00:14<01:47,  2.45s/it] 14%|█▍        | 7/50 [00:17<01:44,  2.44s/it] 16%|█▌        | 8/50 [00:19<01:42,  2.44s/it] 18%|█▊        | 9/50 [00:22<01:39,  2.43s/it] 20%|██        | 10/50 [00:24<01:37,  2.43s/it] 22%|██▏       | 11/50 [00:26<01:34,  2.43s/it] 24%|██▍       | 12/50 [00:29<01:32,  2.43s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.42s/it] 28%|██▊       | 14/50 [00:34<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.42s/it] 32%|███▏      | 16/50 [00:39<01:22,  2.43s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.42s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.43s/it] 38%|███▊      | 19/50 [00:46<01:15,  2.42s/it] 40%|████      | 20/50 [00:48<01:12,  2.42s/it] 42%|████▏     | 21/50 [00:51<01:09,  2.41s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.42s/it] 46%|████▌     | 23/50 [00:56<01:05,  2.41s/it] 48%|████▊     | 24/50 [00:58<01:02,  2.42s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:03<00:58,  2.42s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:08<00:53,  2.42s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.42s/it] 60%|██████    | 30/50 [01:12<00:48,  2.42s/it] 62%|██████▏   | 31/50 [01:15<00:45,  2.42s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.42s/it] 66%|██████▌   | 33/50 [01:20<00:41,  2.41s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:25<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.42s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.42s/it] 76%|███████▌  | 38/50 [01:32<00:29,  2.43s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:37<00:24,  2.43s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:42<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.42s/it] 90%|█████████ | 45/50 [01:49<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:54<00:07,  2.42s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.42s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.43s/it]
5 14 2.463500738143921
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:15,  2.76s/it]  4%|▍         | 2/50 [00:05<02:03,  2.57s/it]  6%|▌         | 3/50 [00:07<01:57,  2.50s/it]  8%|▊         | 4/50 [00:10<01:53,  2.47s/it] 10%|█         | 5/50 [00:12<01:50,  2.45s/it] 12%|█▏        | 6/50 [00:14<01:47,  2.45s/it] 14%|█▍        | 7/50 [00:17<01:44,  2.44s/it] 16%|█▌        | 8/50 [00:19<01:42,  2.43s/it] 18%|█▊        | 9/50 [00:22<01:39,  2.43s/it] 20%|██        | 10/50 [00:24<01:37,  2.43s/it] 22%|██▏       | 11/50 [00:26<01:34,  2.42s/it] 24%|██▍       | 12/50 [00:29<01:32,  2.43s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.42s/it] 28%|██▊       | 14/50 [00:34<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.41s/it] 32%|███▏      | 16/50 [00:39<01:22,  2.42s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.42s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.42s/it] 38%|███▊      | 19/50 [00:46<01:14,  2.42s/it] 40%|████      | 20/50 [00:48<01:12,  2.42s/it] 42%|████▏     | 21/50 [00:51<01:10,  2.42s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.42s/it] 46%|████▌     | 23/50 [00:55<01:05,  2.42s/it] 48%|████▊     | 24/50 [00:58<01:02,  2.42s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:03<00:58,  2.42s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:08<00:53,  2.41s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.41s/it] 60%|██████    | 30/50 [01:12<00:48,  2.41s/it] 62%|██████▏   | 31/50 [01:15<00:45,  2.41s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.42s/it] 66%|██████▌   | 33/50 [01:20<00:41,  2.42s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.43s/it] 70%|███████   | 35/50 [01:25<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:34,  2.43s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.43s/it] 76%|███████▌  | 38/50 [01:32<00:29,  2.43s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:37<00:24,  2.42s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:42<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.42s/it] 90%|█████████ | 45/50 [01:49<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.43s/it] 94%|█████████▍| 47/50 [01:54<00:07,  2.42s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.43s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.43s/it]100%|██████████| 50/50 [02:01<00:00,  2.43s/it]
6 14 1.682394027709961
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<01:57,  2.41s/it]  4%|▍         | 2/50 [00:04<01:56,  2.43s/it]  6%|▌         | 3/50 [00:07<01:53,  2.42s/it]  8%|▊         | 4/50 [00:09<01:51,  2.42s/it] 10%|█         | 5/50 [00:12<01:48,  2.42s/it] 12%|█▏        | 6/50 [00:14<01:46,  2.42s/it] 14%|█▍        | 7/50 [00:16<01:44,  2.42s/it] 16%|█▌        | 8/50 [00:19<01:41,  2.43s/it] 18%|█▊        | 9/50 [00:21<01:39,  2.42s/it] 20%|██        | 10/50 [00:24<01:36,  2.42s/it] 22%|██▏       | 11/50 [00:26<01:34,  2.42s/it] 24%|██▍       | 12/50 [00:29<01:32,  2.42s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.42s/it] 28%|██▊       | 14/50 [00:33<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.42s/it] 32%|███▏      | 16/50 [00:38<01:22,  2.42s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.42s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.42s/it] 38%|███▊      | 19/50 [00:45<01:15,  2.42s/it] 40%|████      | 20/50 [00:48<01:12,  2.42s/it] 42%|████▏     | 21/50 [00:50<01:10,  2.42s/it] 44%|████▍     | 22/50 [00:53<01:07,  2.42s/it] 46%|████▌     | 23/50 [00:55<01:05,  2.42s/it] 48%|████▊     | 24/50 [00:58<01:02,  2.42s/it] 50%|█████     | 25/50 [01:00<01:00,  2.42s/it] 52%|█████▏    | 26/50 [01:02<00:58,  2.42s/it] 54%|█████▍    | 27/50 [01:05<00:55,  2.42s/it] 56%|█████▌    | 28/50 [01:07<00:53,  2.42s/it] 58%|█████▊    | 29/50 [01:10<00:50,  2.42s/it] 60%|██████    | 30/50 [01:12<00:48,  2.43s/it] 62%|██████▏   | 31/50 [01:15<00:45,  2.42s/it] 64%|██████▍   | 32/50 [01:17<00:43,  2.42s/it] 66%|██████▌   | 33/50 [01:19<00:41,  2.41s/it] 68%|██████▊   | 34/50 [01:22<00:38,  2.42s/it] 70%|███████   | 35/50 [01:24<00:36,  2.42s/it] 72%|███████▏  | 36/50 [01:27<00:33,  2.42s/it] 74%|███████▍  | 37/50 [01:29<00:31,  2.41s/it] 76%|███████▌  | 38/50 [01:31<00:29,  2.42s/it] 78%|███████▊  | 39/50 [01:34<00:26,  2.42s/it] 80%|████████  | 40/50 [01:36<00:24,  2.42s/it] 82%|████████▏ | 41/50 [01:39<00:21,  2.42s/it] 84%|████████▍ | 42/50 [01:41<00:19,  2.42s/it] 86%|████████▌ | 43/50 [01:44<00:16,  2.42s/it] 88%|████████▊ | 44/50 [01:46<00:14,  2.42s/it] 90%|█████████ | 45/50 [01:48<00:12,  2.42s/it] 92%|█████████▏| 46/50 [01:51<00:09,  2.42s/it] 94%|█████████▍| 47/50 [01:53<00:07,  2.42s/it] 96%|█████████▌| 48/50 [01:56<00:04,  2.42s/it] 98%|█████████▊| 49/50 [01:58<00:02,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]100%|██████████| 50/50 [02:01<00:00,  2.42s/it]
7 14 2.5137245655059814
(3132, 662) merged_viz.size 15 len(images)
results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000/generated sample_dir
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<01:58,  2.42s/it]  4%|▍         | 2/50 [00:04<01:56,  2.43s/it]  6%|▌         | 3/50 [00:07<01:53,  2.42s/it]  8%|▊         | 4/50 [00:09<01:51,  2.43s/it] 10%|█         | 5/50 [00:12<01:49,  2.42s/it] 12%|█▏        | 6/50 [00:14<01:46,  2.42s/it] 14%|█▍        | 7/50 [00:16<01:44,  2.42s/it] 16%|█▌        | 8/50 [00:19<01:41,  2.42s/it] 18%|█▊        | 9/50 [00:21<01:38,  2.41s/it] 20%|██        | 10/50 [00:24<01:36,  2.42s/it] 22%|██▏       | 11/50 [00:26<01:34,  2.42s/it] 24%|██▍       | 12/50 [00:29<01:31,  2.42s/it] 26%|██▌       | 13/50 [00:31<01:29,  2.42s/it] 28%|██▊       | 14/50 [00:33<01:27,  2.42s/it] 30%|███       | 15/50 [00:36<01:24,  2.42s/it] 32%|███▏      | 16/50 [00:38<01:22,  2.42s/it] 34%|███▍      | 17/50 [00:41<01:19,  2.42s/it] 36%|███▌      | 18/50 [00:43<01:17,  2.42s/it] 38%|███▊      | 19/50 [00:45<01:14,  2.42s/it] 40%|████      | 20/50 [00:48<01:11,  2.37s/it] 42%|████▏     | 21/50 [00:50<01:07,  2.33s/it] 44%|████▍     | 22/50 [00:52<01:05,  2.33s/it] 46%|████▌     | 23/50 [00:54<00:59,  2.20s/it] 48%|████▊     | 24/50 [00:56<00:54,  2.10s/it] 50%|█████     | 25/50 [00:59<00:55,  2.23s/it] 52%|█████▏    | 26/50 [01:02<01:03,  2.66s/it] 54%|█████▍    | 27/50 [01:06<01:08,  2.96s/it] 56%|█████▌    | 28/50 [01:10<01:09,  3.16s/it] 58%|█████▊    | 29/50 [01:13<01:09,  3.32s/it] 60%|██████    | 30/50 [01:17<01:08,  3.42s/it] 62%|██████▏   | 31/50 [01:21<01:06,  3.50s/it] 64%|██████▍   | 32/50 [01:24<01:03,  3.54s/it] 66%|██████▌   | 33/50 [01:28<01:00,  3.56s/it] 68%|██████▊   | 34/50 [01:32<00:57,  3.61s/it] 70%|███████   | 35/50 [01:35<00:54,  3.62s/it] 72%|███████▏  | 36/50 [01:39<00:50,  3.64s/it] 74%|███████▍  | 37/50 [01:43<00:47,  3.64s/it] 76%|███████▌  | 38/50 [01:46<00:43,  3.64s/it] 78%|███████▊  | 39/50 [01:50<00:40,  3.66s/it] 80%|████████  | 40/50 [01:54<00:36,  3.66s/it] 82%|████████▏ | 41/50 [01:57<00:32,  3.65s/it] 84%|████████▍ | 42/50 [02:01<00:29,  3.65s/it] 86%|████████▌ | 43/50 [02:04<00:25,  3.65s/it] 88%|████████▊ | 44/50 [02:08<00:21,  3.66s/it] 90%|█████████ | 45/50 [02:12<00:18,  3.67s/it] 92%|█████████▏| 46/50 [02:15<00:14,  3.66s/it] 94%|█████████▍| 47/50 [02:19<00:10,  3.66s/it] 96%|█████████▌| 48/50 [02:23<00:07,  3.67s/it] 98%|█████████▊| 49/50 [02:27<00:03,  3.67s/it]100%|██████████| 50/50 [02:30<00:00,  3.68s/it]100%|██████████| 50/50 [02:30<00:00,  3.01s/it]
Traceback (most recent call last):
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/cd_generate.py", line 448, in <module>
    main(args)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/cd_generate.py", line 397, in main
    images = pipeline(prompt=prompts, 
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py", line 1040, in __call__
    image = self.vae.decode(latents / self.vae.config.scaling_factor, return_dict=False, generator=generator)[
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/utils/accelerate_utils.py", line 46, in wrapper
    return method(self, *args, **kwargs)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/models/autoencoders/autoencoder_kl.py", line 321, in decode
    decoded = self._decode(z).sample
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/models/autoencoders/autoencoder_kl.py", line 292, in _decode
    dec = self.decoder(z)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/models/autoencoders/vae.py", line 337, in forward
    sample = up_block(sample, latent_embeds)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/models/unets/unet_2d_blocks.py", line 2750, in forward
    hidden_states = upsampler(hidden_states)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/twkim/project/rich_context_qlab04/custom_diffusion/./packages/diffusers/models/upsampling.py", line 180, in forward
    hidden_states = self.conv(hidden_states)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.88 GiB. GPU 0 has a total capacty of 23.67 GiB of which 1.41 GiB is free. Process 4099746 has 14.70 GiB memory in use. Including non-PyTorch memory, this process has 7.55 GiB memory in use. Of the allocated memory 6.93 GiB is allocated by PyTorch, and 326.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Traceback (most recent call last):
  File "/home/twkim/anaconda3/envs/context/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1023, in launch_command
    simple_launcher(args)
  File "/home/twkim/anaconda3/envs/context/lib/python3.9/site-packages/accelerate/commands/launch.py", line 643, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/home/twkim/anaconda3/envs/context/bin/python', 'cd_generate.py', '--pretrained_model_name_or_path=runwayml/stable-diffusion-v1-5', '--train_data_dir1=/data/twkim/diffusion/personalization/collected/images/duck_toy', '--placeholder_token1=<duck_toy>', '--resolution=512', '--eval_batch_size=15', '--num_images_per_prompt=8', '--output_dir=results/cd_results/single_mtarget_seed7777_rep1/duck_toy', '--seed=7777', '--mask_tokens=[MASK]', '--resume_cd_path=saved_models/cd_models/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr1e5/checkpoints/checkpoint-500/custom_diffusion.pt', '--learned_embed_path1=saved_models/cd_models/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti/checkpoints/checkpoint-1000/learned_embeds.pt', '--dst_exp_path=results/cd_results/single_mtarget_seed7777_rep1/duck_toy/cd_cnetv4_mlm00005_duck_toy_mprob025_mbatch25_mtarget_masked_lr5e4_ti_s1000', '--train_prior_concept1=duck', '--eval_prior_concept1=duck toy', '--train_prompt_type=nonliving', '--eval_prompt_type=nonliving', '--benchmark_path=../datasets_pkgs/eval_prompts/dreambooth.json', '--include_prior_concept=1']' returned non-zero exit status 1.
